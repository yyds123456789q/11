<!DOCTYPE html>
<html lang=zh-CN>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>åº”ç”¨æ£€æµ‹ - åŠ è½½é€Ÿåº¦æµ‹è¯•</title>
<style>
body{font-family:system-ui,sans-serif;background:#f5f7fa;margin:0;padding:20px;color:#333}
.container{max-width:500px;margin:0 auto}
.card{background:#fff;border-radius:12px;padding:20px;margin:15px 0;box-shadow:0 2px 8px rgba(0,0,0,.1)}
.title{font-size:20px;font-weight:bold;margin-bottom:15px;color:#333}
.info{background:#e3f2fd;padding:15px;border-radius:8px;margin:10px 0;border-left:4px solid #1976d2}
.warning{background:#fff3cd;padding:15px;border-radius:8px;margin:10px 0;border-left:4px solid #ffc107;color:#856404}
.success{background:#d4edda;padding:15px;border-radius:8px;margin:10px 0;border-left:4px solid #28a745;color:#155724}
.btn{background:#007acc;color:#fff;border:none;padding:12px 20px;border-radius:6px;cursor:pointer;margin:5px;font-size:14px}
.btn:hover{background:#0056b3}
.speed-test{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:8px}
.result{font-weight:bold;font-size:16px;margin:10px 0}
</style>
</head>
<body>
<div class=container>
<div class=card>
<div class=title>ğŸ“± åº”ç”¨ç¯å¢ƒæ£€æµ‹</div>
<div id=appInfo></div>
<div id=recommendations></div>
</div>

<div class=card>
<div class=title>âš¡ åŠ è½½é€Ÿåº¦æµ‹è¯•</div>
<div class=speed-test>
<p>é¡µé¢åŠ è½½æ—¶é—´ï¼š<span id=loadTime class=result>è®¡ç®—ä¸­...</span></p>
<p>å½“å‰ç½‘ç»œçŠ¶æ€ï¼š<span id=networkStatus class=result>æ£€æµ‹ä¸­...</span></p>
<p>å»ºè®®ä¼˜åŒ–æ–¹æ¡ˆï¼š<span id=optimization class=result>åˆ†æä¸­...</span></p>
</div>
<button class=btn onclick=runSpeedTest()>é‡æ–°æµ‹è¯•é€Ÿåº¦</button>
<button class=btn onclick=openOptimizedPage()>æ‰“å¼€ä¼˜åŒ–ç‰ˆæœ¬</button>
</div>

<div class=card>
<div class=title>ğŸ”— æµ‹è¯•é“¾æ¥</div>
<p>æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥æµ‹è¯•ä¸åŒç‰ˆæœ¬çš„åŠ è½½é€Ÿåº¦ï¼š</p>
<div style="margin:15px 0">
<button class=btn onclick="window.open('index.html','_blank')">åŸç‰ˆé¡µé¢</button>
<button class=btn onclick="window.open('universal-fast.html','_blank')">é€šç”¨ä¼˜åŒ–ç‰ˆ</button>
<button class=btn onclick="window.open('wechat-fast.html','_blank')">å¾®ä¿¡ä¸“ç”¨ç‰ˆ</button>
</div>
</div>
</div>

<script>
const startTime=performance.now();

function detectDetailedApp(){
const ua=navigator.userAgent;
const uaLower=ua.toLowerCase();

// è¯¦ç»†çš„åº”ç”¨æ£€æµ‹
if(uaLower.indexOf('micromessenger')!==-1){
const version=ua.match(/micromessenger\/(\d+\.\d+)/i);
return{
name:'å¾®ä¿¡',
code:'wechat',
version:version?version[1]:'æœªçŸ¥',
inApp:true,
optimization:'high'
};
}

if(uaLower.indexOf('qq/')!==-1){
return{
name:'QQ',
code:'qq',
version:'æœªçŸ¥',
inApp:true,
optimization:'medium'
};
}

if(uaLower.indexOf('weibo')!==-1){
return{
name:'å¾®åš',
code:'weibo',
version:'æœªçŸ¥',
inApp:true,
optimization:'medium'
};
}

if(uaLower.indexOf('zhihu')!==-1){
return{
name:'çŸ¥ä¹',
code:'zhihu',
version:'æœªçŸ¥',
inApp:true,
optimization:'low'
};
}

if(uaLower.indexOf('aweme')!==-1||uaLower.indexOf('tiktok')!==-1){
return{
name:'æŠ–éŸ³/TikTok',
code:'douyin',
version:'æœªçŸ¥',
inApp:true,
optimization:'high'
};
}

if(uaLower.indexOf('taobao')!==-1||uaLower.indexOf('aliapp')!==-1){
return{
name:'æ·˜å®/é˜¿é‡Œç³»åº”ç”¨',
code:'taobao',
version:'æœªçŸ¥',
inApp:true,
optimization:'medium'
};
}

if(uaLower.indexOf('xiaohongshu')!==-1||uaLower.indexOf('redbook')!==-1){
return{
name:'å°çº¢ä¹¦',
code:'xiaohongshu',
version:'æœªçŸ¥',
inApp:true,
optimization:'medium'
};
}

// æ£€æµ‹ç³»ç»Ÿæµè§ˆå™¨
if(uaLower.indexOf('safari')!==-1&&uaLower.indexOf('chrome')===-1){
return{
name:'Safari',
code:'safari',
version:'æœªçŸ¥',
inApp:false,
optimization:'none'
};
}

if(uaLower.indexOf('chrome')!==-1){
return{
name:'Chrome',
code:'chrome',
version:'æœªçŸ¥',
inApp:false,
optimization:'none'
};
}

return{
name:'æœªçŸ¥æµè§ˆå™¨',
code:'unknown',
version:'æœªçŸ¥',
inApp:false,
optimization:'unknown'
};
}

function displayAppInfo(){
const app=detectDetailedApp();
const appInfoDiv=document.getElementById('appInfo');
const recommendationsDiv=document.getElementById('recommendations');

let infoHtml=`
<div class="${app.inApp?'warning':'success'}">
<strong>å½“å‰ç¯å¢ƒï¼š</strong>${app.name} ${app.version}<br>
<strong>æ˜¯å¦åº”ç”¨å†…ï¼š</strong>${app.inApp?'æ˜¯':'å¦'}<br>
<strong>ç”¨æˆ·ä»£ç†ï¼š</strong><small>${navigator.userAgent}</small>
</div>
`;

let recommendationHtml='';
if(app.inApp){
switch(app.optimization){
case 'high':
recommendationHtml=`
<div class=info>
<strong>ğŸš€ é«˜ä¼˜å…ˆçº§ä¼˜åŒ–å»ºè®®ï¼š</strong><br>
1. å¼•å¯¼ç”¨æˆ·åœ¨å¤–éƒ¨æµè§ˆå™¨ä¸­æ‰“å¼€<br>
2. ä½¿ç”¨è½»é‡åŒ–é¡µé¢ç‰ˆæœ¬<br>
3. æ·»åŠ åŠ è½½æç¤ºå’Œè¯´æ˜<br>
4. ä¼˜åŒ–ç½‘ç»œè¯·æ±‚å’Œç¼“å­˜ç­–ç•¥
</div>
`;
break;
case 'medium':
recommendationHtml=`
<div class=info>
<strong>âš¡ ä¸­ç­‰ä¼˜åŒ–å»ºè®®ï¼š</strong><br>
1. æä¾›å¤–éƒ¨æµè§ˆå™¨æ‰“å¼€é€‰é¡¹<br>
2. ç®€åŒ–é¡µé¢å†…å®¹<br>
3. æ·»åŠ åŠ è½½çŠ¶æ€æç¤º
</div>
`;
break;
default:
recommendationHtml=`
<div class=info>
<strong>ğŸ’¡ åŸºç¡€ä¼˜åŒ–å»ºè®®ï¼š</strong><br>
1. å‹ç¼©èµ„æºæ–‡ä»¶<br>
2. ä¼˜åŒ–å›¾ç‰‡åŠ è½½<br>
3. å‡å°‘ä¸å¿…è¦çš„JavaScript
</div>
`;
}
}else{
recommendationHtml=`
<div class=success>
<strong>âœ… å½“å‰ç¯å¢ƒä¼˜è‰¯ï¼š</strong><br>
æ‚¨æ­£åœ¨ä½¿ç”¨ç³»ç»Ÿæµè§ˆå™¨ï¼ŒåŠ è½½é€Ÿåº¦åº”è¯¥å¾ˆå¿«ã€‚å¦‚æœä»ç„¶è¾ƒæ…¢ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜ã€‚
</div>
`;
}

appInfoDiv.innerHTML=infoHtml;
recommendationsDiv.innerHTML=recommendationHtml;
}

function calculateLoadTime(){
const endTime=performance.now();
const loadTime=Math.round(endTime-startTime);
document.getElementById('loadTime').textContent=loadTime+'æ¯«ç§’';

// ç½‘ç»œçŠ¶æ€æ£€æµ‹
const connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection;
let networkInfo='æœªçŸ¥';
if(connection){
networkInfo=`${connection.effectiveType||'æœªçŸ¥'} (${connection.downlink||'æœªçŸ¥'}Mbps)`;
}
document.getElementById('networkStatus').textContent=networkInfo;

// ä¼˜åŒ–å»ºè®®
const app=detectDetailedApp();
let optimization='';
if(loadTime<1000){
optimization='åŠ è½½é€Ÿåº¦è‰¯å¥½ï¼Œæ— éœ€ä¼˜åŒ–';
}else if(loadTime<3000){
optimization=app.inApp?'å»ºè®®ä½¿ç”¨å¤–éƒ¨æµè§ˆå™¨':'å¯è€ƒè™‘é¡µé¢ä¼˜åŒ–';
}else{
optimization=app.inApp?'å¼ºçƒˆå»ºè®®ä½¿ç”¨å¤–éƒ¨æµè§ˆå™¨':'ç½‘ç»œå¯èƒ½è¾ƒæ…¢ï¼Œå»ºè®®ä¼˜åŒ–';
}
document.getElementById('optimization').textContent=optimization;
}

function runSpeedTest(){
const testStart=performance.now();
// æ¨¡æ‹Ÿä¸€äº›èµ„æºåŠ è½½
setTimeout(()=>{
const testEnd=performance.now();
const testTime=Math.round(testEnd-testStart);
alert(`æµ‹è¯•å®Œæˆï¼\nå“åº”æ—¶é—´ï¼š${testTime}æ¯«ç§’\n\n${testTime<500?'ğŸš€ é€Ÿåº¦å¾ˆå¿«':'âš ï¸ å»ºè®®ä¼˜åŒ–'}`);
},100);
}

function openOptimizedPage(){
const app=detectDetailedApp();
if(app.inApp){
window.open('universal-fast.html','_blank');
}else{
window.open('index.html','_blank');
}
}

// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
document.addEventListener('DOMContentLoaded',function(){
displayAppInfo();
setTimeout(calculateLoadTime,100);
});
</script>
</body>
</html>